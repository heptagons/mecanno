\documentclass[11pt]{article}
\title{\textbf{Meccano four frame}}
\author{https://github.com/heptagons/meccano/frames/four}
\date{}

\usepackage{../../meccano}
\usepackage{../frames}
%\usepackage{tikz}
%\usetikzlibrary{calc}
%\usepackage{lipsum}

%\newenvironment{MyColorPar}[1]{
%    \leavevmode\color{#1}\ignorespaces
%}{
%}

\begin{document}

\maketitle
\begin{abstract}
Four frame is a group of four rigid meccano\meccanoref strips.
\end{abstract}

\section{Four frame}

\begin{figure}[H]
 \centering
 \begin{tikzpicture}
  \begin{scope}[scale=1]
   \meccanoframefour{4}{2}{3}{2}{3}{3pt}
  \end{scope}
 \end{tikzpicture}
 \caption{Antisymmetric four frame.}
 \label{fig:four}
\end{figure}

Figure \ref{fig:four} show the antisymmetric four-strips frame.
From the figure we define $\alpha \equiv \angle{BA_1C_1}$ and define integers $m=b^2 + c^2 - a^2$ and $n=2bc$ using the law of cosines, then we calculate $\cos\alpha$ and $\sin\alpha$:
\begin{align}
(\alpha,m,n) &\equiv (\angle{BA_1C_1},b^2 + c^2 - a^2, 2bc) \label{eq:mn}\\
\cos\alpha &= \frac{m}n\\
\sin\alpha &= \frac{\sqrt{n^2-m^2}}n
\end{align}
From the figure \ref{fig:four} we define $\gamma \equiv \angle{BA_2C_2}$ and define integers $s=a^2 + b^2 - c^2$ and $t=2ab$ and calculate $\cos\gamma$ and $\sin\gamma$:
\begin{align}
(\gamma,s,t) &\equiv (\angle{BA_2C_2}, a^2 + b^2 - c^2, 2ab) \label{eq:st}\\
\cos\gamma &= \frac{s}{t}\\
\sin\gamma &= \frac{\sqrt{t^2-s^2}}{t}
\end{align}

We calculate the distance $f = \overline{C_2D}$ with the law of cosines using angle $\alpha$
and defining integers $x = a+c$ and $y = b+d$:
\begin{align}
(x, y) &\equiv (a + c, b + d) \label{eq:xy}\\
f^2 &= (a+c)^2 + (b+d)^2 - 2(a+c)(b+d)\cos\alpha\\
 &= x^2 + y^2 - \frac{2mxy}n\\
f &= \frac{\sqrt{n^2(x^2 + y^2) - 2mnxy}}n
\end{align}

We define a new integer $z \equiv n^2(x^2 + y^2) - 2mnxy$ so we have:
\begin{align}
z &\equiv n^2(x^2 + y^2) - 2mnxy\\
f &= \frac{\sqrt{z}}n
\end{align}

We define angle $\theta \equiv \angle{A_1C_2D}$ and calculate $\cos\theta$ and $\sin\theta$:
\begin{align}
\theta &\equiv \angle{A_1C2D}\\
\cos\theta &= \frac{(a+c)^2 + f^2 - (b+d)^2}{2(a+c)f}\nonumber\\
 &= \frac{x^2 + f^2 - y^2}{2xf}\nonumber\\
 &= \frac{x^2 + x^2 + y^2 - \dfrac{2mxy}{n} - y^2}{2x\dfrac{\sqrt{z}}{n}}\nonumber\\
 &= \frac{nx - my}{\sqrt{z}}\\
\sin^2\theta &= 1 - \cos^2\theta = \frac{z - (nx - my)^2}z\nonumber\\
 &= \frac{n^2(x^2 + y^2) - 2mnxy - (nx-my)^2}z\nonumber\\
 &= \frac{n^2(x^2 + y^2) - 2mnxy - n^2x^2 +2nxmy - m^2y^2}z\nonumber\\
\sin\theta &= \frac{y\sqrt{n^2 - m^2}}{\sqrt{z}}
\end{align}

We define angle $\phi \equiv \angle{A_2C_2D}$ and we note is the sum of angles $\theta + \gamma$ and we calculate $\cos\phi$:
\begin{align}
\phi &\equiv \angle{A_2C_2D}\\
 &= \theta + \gamma\\
\cos\phi &= \cos(\theta + \gamma)\\
 &= \cos\theta\cos\gamma - \sin\theta\sin\gamma\nonumber\\
 &= \frac{(nx - my)s}{\sqrt{z}t} - \frac{(y\sqrt{n^2 - m^2})\sqrt{t^2-s^2}}{\sqrt{z}t}\nonumber\\
 &= \frac{(nx - my)s - y\sqrt{(n^2 - m^2)(t^2-s^2)}}{\sqrt{z}t} \label{eq:complex}
\end{align}

We simplify $\sqrt{(n^2-m^2)(t^2-s^2)}$:
\begin{align}
(n^2-m^2)(t^2-s^2) &= (n-m)(n+m)(t-s)(t+s)\nonumber\\
 &= (2bc-(b^2+c^2-a^2))(2bc+b^2+c^2-a^2)(2ab-(a^2+b^2-c^2))(2ab+a^2+b^2-c^2)\nonumber\\
 &= (a^2-(b-c)^2) ((b+c)^2-a^2) (c^2-(a-b)^2) ((a+b)^2-c^2)\nonumber\\
 &= (a+b-c)(a-b+c) (b+c+a)(b+c-a) (c+a-b)(c-a+b) (a+b+c)(a+b-c)\nonumber\\
 &= (a+b+c)^2(a+b-c)^2(a-b+c)^2(-a+b+c)^2\nonumber\\
\sqrt{(n^2-m^2)(t^2-s^2)} &= (a+b+c)(a+b-c)(a-b+c)(-a+b+c)\nonumber\\
 &= ((a+b)^2-c^2)(c^2-(a-b)^2)\nonumber\\
 &= (s+t)(m+n) \label{eq:simple}
\end{align}

We substitute equation \ref{eq:simple} into equation \ref{eq:complex} and we get:
\begin{align}
\cos\phi &= \frac{(nx - my)s - y(m+n)(s+t)}{\sqrt{z}t}
\end{align}

From the figure we define angle $\psi \equiv \angle{DC_2E}$ and we note equals angle $\pi - \phi$, so we have:
\begin{align}
\psi &\equiv \angle{DC_2E}\\
 &= \pi - \phi\\
\cos\psi &= \cos(\pi - \phi)\\
 &= -\cos\phi\nonumber\\
 &= \frac{-(nx - my)s + y(m+n)(s+t)}{\sqrt{z}t}
\end{align}

Finally with $\cos\psi$, $e$ and $f$ we can calculate distance $g = \overline{ED}$:
\begin{align}
g^2 &= e^2 + f^2 - 2ef\cos\psi\\
 &= e^2 + x^2 + y^2 - \frac{2mxy}{n} 
 - 2e\left(\frac{\sqrt{z}}n\right)\left(\frac{-(nx - my)s + y(m+n)(s+t)}{\sqrt{z}t}\right)\\
 &= e^2 + x^2 + y^2 - \frac{2mxy}{n} 
 + 2e\frac{(nx - my)s - y(m+n)(s+t)}{nt}\\
 &= \frac{
  (e^2 + x^2 + y^2)nt - 2mxyt + 2es(nx - my) - 2ey(m+n)(s+t)
 }{nt}\nonumber\\
g &= \frac{\sqrt{
(e^2 + x^2 + y^2)n^2t^2 - 2mnxyt^2 + 2esnt(nx - my) - 2eynt(m+n)(s+t)
}}{nt}
\end{align}

\subsection{Antisymmetric four frame software}



% DON'T CLEAR will be used for asymmetric four-strips 
%\subsection{Antisymmetric four frame software}
%
%From the last equation of $g$ we identify three \texttt{input} integers $i_1,i_2,i_3$ which are used to get $g(i)$. Then the nested radicals software will return square-free \texttt{output} integers $z_1,z_2,z_3,z_4,z_5$ as $g(z)$:
%\begin{align}
%i_1 &= nt\\
%i_2 &= i_1^2(e^2 + x^2 + y^2) - 2i_1mxyt + 2i_1es(nx - my)\\
%i_3 &= - 2i_1ey\\
%i_4 &= (n^2 - m^2)(t^2-s^2)\\
%g(i) &= \frac{\sqrt{i_2+i_3\sqrt{i_4}}}{i_1}\\
%g(z) &= \frac{z_2\sqrt{z_3+z_4\sqrt{z_5}}}{z_1}
%\end{align}
%where $m,n$ are calculated with equations \ref{eq:mn}, $x,y$ are calculated with equations \ref{eq:xy} and $s,t$ are calculated with equations \ref{eq:st}.

\end{document}
