\documentclass{article}
\usepackage{amsmath}
\usepackage{../../meccano}
\usepackage{chngcntr}
\counterwithin{equation}{section}

\begin{document}

\section{32 bits algebraic numbers}

Let $r_0$, $r_1$, $r_2$ and $r_3$ irreducibles radicals with nesting 0, 1, 2 and 3:
\begin{align}
r_0 &= \pm b\\
r_1 &= \pm c\sqrt{d}\\
r_2 &= \pm e\sqrt{f \pm g\sqrt{h}}\\
r_3 &= \pm i\sqrt{j \pm k\sqrt{l \pm m\sqrt{n}}}
\end{align}

We will use fourteen different 32-bit natural numbers, where $a$ goes in the denominators and $b,...n$ 
in the numerators.
\begin{align}
1 &\leq a       \leq 2^{32} - 1\\
0 &\leq b,c,d,e,f,g,h,i,j,k,l,m,n \leq 2^{32} - 1
\end{align}
The signs are managed appart as extra boolean variables and there is one for each of the seven variables
$b$, $c$, $e$, $g$, $i$, $k$ and $m$.

\subsection{Reduction of $r_1$}
\begin{align}
r_1 &= \pm c\sqrt{d}\\
d   &= p^2c\\
d_1 &= \begin{cases}
 d &\text{if } p = 1\\
 q &\text{if } p > 1\\
\end{cases}\\
c_1 &= \begin{cases}
 c  &\text{if } p = 1\\
 cp &\text{if } p > 1\\
\end{cases}\\
r_1 &= \pm c_1\sqrt{d_1}
\end{align}

\subsection{Reduction of $r_2$}
\begin{align}
r_2 &= \pm e\sqrt{f \pm g\sqrt{h}}\\
h   &= p^2q\\
h_1 &= \begin{cases}
 h &\text{if } p = 1\\
 q &\text{if } p > 1\\
\end{cases}\\
g_1 &= \begin{cases}
 g  &\text{if } p = 1\\
 gp &\text{if } p > 1\\
\end{cases}\\
r_2 &= \pm e\sqrt{f \pm g_1\sqrt{h_1}}\\
f &= r^2s \textbf{ and } g_1 = r^2t, r^2 \textbf{ lcc of } f \textbf{ and } g\\
g_2 &= \begin{cases}
 g_1 &\text{if } r = 1\\
 t   &\text{if } r > 1\\
\end{cases}\\
f_1 &= \begin{cases}
 f &\text{if } r = 1\\
 s &\text{if } r > 1\\
\end{cases}\\
e_1 &= \begin{cases}
 e &\text{if } r = 1\\
 r &\text{if } r > 1\\
\end{cases}\\
r_2 &= \pm e_1\sqrt{f_1 \pm g_2\sqrt{h_1}}\\
\end{align}



We define four numbers of increasing complexity:
\begin{align}
B &\equiv \frac{r_0}{a} \\
D &\equiv \frac{r_0 + r_1}{a} \iff c,d > 0 \\
H &\equiv \frac{r_0 + r_1 + r_2}{a} \iff e,f,g,h > 0 \\
N &\equiv \frac{r_0 + r_1 + r_2 + r_3}{a} \iff i,j,k,l,m,n > 0
\end{align}


\section{functions}
Each of the radicals $r_0,...,r_3$ has a function to read their corresponding signs and integers variables:
\begin{align}
f_0 &\equiv f(\pm b)\\
f_1 &\equiv f(\pm c, d)\\
f_2 &\equiv f(\pm e, f, \pm g, h)\\
f_3 &\equiv f(\pm i, j, \pm k, l, \pm m, n)
\end{align}
Each $f_0,...f_4$ reduces the values with $\gcd$ and root simplifications.

Each of the algebraic numbers $B$, $D$, $H$ and $N$ has a function to read their radicals functions as inputs:
\begin{align}
f_B &\equiv f(f_0(...), a)\\
f_D &\equiv f(f_0(...), f_1(...), a)\\
f_H &\equiv f(f_0(...), f_1(...), f_2(...), a)\\
f_N &\equiv f(f_0(...), f_1(...), f_2(...), f_3(...), a)
\end{align}
Each $f_B,...f_N$ adds the radicals reducing once more the variables with $\gcd$ root simplifications
and now considering the denominator $a$.

\section{Examples}

\subsection{$f_B$ examples}
\begin{align}
\cos{0}             &= 1           \implies f_B(f_0(1),1)\\
\sin{\frac{\pi}{6}} &= \frac{1}{2} \implies f_B(f_0(1),2)
\end{align}

\subsection{$f_D$ examples}
\begin{align}
\sin{\frac{\pi}{4}}  &= \frac{\sqrt{2}}{2}    \implies f_D(\emptyset,f_1(1,2),2)\\
\sin{\frac{\pi}{10}} &= \frac{-1+\sqrt{5}}{4} \implies f_D(f_0(-1),f_1(1,5),4)
\end{align}

\subsection{$f_H$ examples}
\begin{align}
\sin{\frac{\pi}{5}}  &= \frac{\sqrt{10-2\sqrt{5}}}{4} \implies f_H(\emptyset,\emptyset,f_2(1,10,-2,5),4)\\
\sin{\frac{\pi}{12}} &= \frac{\sqrt{6} + \sqrt{2}}{4} \implies f_H(\emptyset,f_1(1,6),f_2(1,2,0,0),4) *\\
\sin{\frac{\pi}{12}} &= \frac{\sqrt{2 + \sqrt{3}}}{2} \implies f_H(\emptyset,\emptyset,f_2(1,2,1,3),2)\\
\cos{\frac{\pi}{15}} &= \frac{1+\sqrt{5}+\sqrt{30-6\sqrt{5}}}{8} \implies f_E(f_0(1),f_1(1,5),f_2(1,30,-6,5),8)
\end{align}

\subsection{$f_N$ examples}
\begin{align}
\cos{\frac{\pi}{16}} &= \frac{\sqrt{2+\sqrt{2+\sqrt{2}}}}{2}
  \\&\implies f_N(\emptyset,\emptyset,\emptyset,f_3(1,2,1,2,1,2),2) \nonumber \\
\cos{\frac{\pi}{24}} &= \frac{\sqrt{2+\sqrt{2+\sqrt{3}}}}{2}
  \\&\implies f_N(\emptyset,\emptyset,\emptyset,f_3(1,2,1,2,1,3),2) \nonumber \\
\cos{\frac{2\pi}{17}} &=
\frac{-1+\sqrt{17}+\sqrt{34-2\sqrt{17}}+2\sqrt{17+3\sqrt{17}-\sqrt{170+38\sqrt{17}}}}{16}
    \\&\implies f_N(f_0(-1),f_1(1,17),f_2(1,34,-2,17),f_3(2,17,3,17,-1,170,+38,17),16) \nonumber \\
\end{align}

\section{Operations with result B}

\subsection{NewB $B = B_1$}
\begin{align}
B_1 &= \frac{\pm b_1}{a_1}\\
 &\quad \textbf{ Reduce } \{ a,b \} = \{a_1/G,b_1/G\} \iff G = \gcd \{a_1,b_1\} > 1 \nonumber \\
 &= \frac{\pm b}{a}
\end{align}

\subsection{AddBB $B = B_2 + B_3$}
\begin{align}
B_2 + B_3 &= \frac{\pm b_2}{a_2} + \frac{\pm b_3}{a_3} \\
 &= \frac{\pm b_2a_3 \pm b_3a_2 }{a_2a_3} = \frac{q}{p} \\
 &\quad \textbf{ Reduce } \{ a_1,b_1 \} = \{p/G, q/G\} \iff G = \gcd \{ p,q \} > 1 \nonumber \\
 &= \frac{\pm b_1 }{ a_1 } \textbf{ Solve as NewB }
\end{align}

\subsection{MulBB $B = B_2 \times B_3$}
\begin{align}
B_2 \times B_3 &= \frac{\pm b_2}{a_2} \times \frac{\pm b_3}{a_3} \\
  &= \frac{\pm b_2b_3}{a_2a_3} = \frac{q}{p} \\
 &\quad \textbf{ Reduce } \{ a_1,b_1 \} = \{p/G, q/G\} \iff G = \gcd \{ p,q \} > 1 \nonumber \\
 &= \frac{\pm b_1 }{ a_1 } \textbf{ Solve as NewB }
\end{align}

\subsection{InvB $B = 1 / B_2$}
\begin{align}
\frac{1}{B_2} &= \frac{1}{\pm b_2 / a_2}\\
 &= \frac{\pm a_2}{b_2} = \frac{q}{p} \\
 &\quad \textbf{ Reduce } \{ a_1,b_1 \} = \{p/G, q/G\} \iff G = \gcd \{ p,q \} > 1 \nonumber \\
 &= \frac{\pm b_1 }{ a_1 } \textbf{ Solve as NewB }
\end{align}

\section{Operations with result D}

\subsection{NewD $D = D_1$}
\begin{align}
D_1 &= \frac{\pm b_1 \pm c_1\sqrt{d_1}}{a_1}\\
 &\quad \textbf{ Reduce } \{p,q,r\} = \{a_1/G,b_1/G,c_1/G\} \iff G = \gcd \{a_1,b_1,c_1\} > 1 \nonumber \\
 &= \frac{\pm q \pm r\sqrt{d_1}}{p} \\
 &\quad \textbf{ Reduce } \{ d \} = s^2d_1 \iff s>1 \nonumber \\
 &= \frac{\pm q \pm rs\sqrt{d}}{p}\\
 &\quad \textbf{ Reduce } \{a,b,c\} = \{p/G,q/G,rs/G\} \iff G = \gcd \{p,q,rs\} \nonumber \\
 &= \frac{\pm b \pm c\sqrt{d}}{a}
\end{align}

\subsection{SqrtB $D = \sqrt{B_2}$}
\begin{align}
\sqrt{B_2} &= \sqrt{\frac{\pm b_2}{a_2}}\\
 &= \frac{\sqrt{a_2b_2}}{a_2}\\
 &\quad \textbf{ Set } \{ a_1, b_1, c_1, d_1\} = \{ a_2, 0, 1, a_2b_2\} \nonumber \\
 &= \frac{\pm b_1 \pm c_1\sqrt{d_1}}{a_1} \textbf{ Solve as NewD }
\end{align}

\subsection{InvD $D = 1 / D_2$}
\begin{align*}
1 / D_2 &= \frac{a_2}{\pm b_2 \pm c_2\sqrt{d_2}} \\
 &= \frac{\pm a_2b_2 \mp a_2c_2\sqrt{d_2}}{b_2^2 - c_2^2d_2}\\
 &\quad \textbf{ Set } \{ a_1, b_1, c_1, d_1\} = \{ b_2^2 - c_2^2d_2, \pm a_2b_2, \mp a_2c_2, d_2\} \nonumber\\
 &= \frac{\pm b_1 \pm c_1\sqrt{d_1}}{a_1} \textbf{ Solve as NewD } \nonumber
\end{align*}


%\subsection{$B_1 + C_2 = D_3$}
%\begin{align*}
%B_1 + C_2 &= \frac{\pm a_1}{b_1} + \frac{\pm a_2\sqrt{c_2}}{b_2}\\
% &= \frac{\pm a_2b_1\sqrt{c_2} \pm a_1b_2 }{b_1b_2}\\
% &= \frac{\pm a_3\sqrt{c_2} \pm d_3 }{b_3} & (\pm a_3, b_3, \pm d_3) = gcd{\pm a_2b_1}{b_1b_2}{\pm a_1b_2}
%\end{align*}

%\subsection{$B_1 + D_2 = D_3$}
%\begin{align*}
%B_1 + D_2 &= \frac{\pm a_1}{b_1} + \frac{\pm a_2\sqrt{c_2} \pm d_2}{b_2}\\
% &= \frac{\pm a_2b_1\sqrt{c_2} \pm a_1b_2 \pm d_2b_1 }{b_1b_2}\\
% &= \frac{\pm a_3\sqrt{c_2} \pm d_3 }{b_3} & (\pm a_3, b_3, \pm d_3) = gcd(\pm a_2b_1,b_1b_2,\pm a_1b_2 \pm d_2b_1)
%\end{align*}

%\subsection{$B_1 + F_2 = F_3$} %7
%\begin{align*}
%B_1 + F_2 &= \frac{\pm a_1}{b_1} + \frac{\pm a_2\sqrt{c_2 \pm e_2\sqrt{f_2}} \pm d_2}{b_2}\\
% &= \frac{\pm a_2b1\sqrt{c_2 \pm e_2\sqrt{f_2}} \pm a_1b_2 \pm d_2b_1}{b_1b_2}\\
% &= \frac{\pm a_3\sqrt{c_2 \pm e_2\sqrt{f_2}} \pm d_3}{b_3} & (\pm a_3, b_3, \pm d_3)=gcd(\pm a_2b1,b_1b_2,\pm a_1b_2 \pm %d_2b_1)
%\end{align*}



\section{Operations with result $H$}

\subsection{$D_1 + D_2 \mapsto H$ <<<<<}
\begin{align}
D_1 + D_2 &= \frac{\pm b_1 \pm c_1\sqrt{d_1}}{a_1} + \frac{\pm b_2 \pm c_2\sqrt{d_2}}{a_2}\\
 &= \frac{(\pm a_2b_1 \pm a_1b_2) \pm a_2c_1\sqrt{d_1} \pm a_1c_2\sqrt{d_2}}{a_1a_2}\\
 &= \frac{\pm q \pm r\sqrt{d_1} \pm s\sqrt{d_2}}{p} \\
 &\quad \textbf{ where } \{ p,q,r,s \} = \gcd \{ a_1a_2, (\pm a_2b_1 \pm a_1b_2), \pm a_2c_1, \pm a_1c_2 \} \nonumber \\
 &= \frac{\pm q \pm \sqrt{r^2d_1 + s^2d_2 \pm 2rs\sqrt{d_1d_2}}}{p} \\
 &= \frac{\pm q \pm \sqrt{t \pm 2rsu\sqrt{h}}}{p} \\
 &\quad \textbf{ where } \{ t \} = r^2d_1 + s^2d_2 \textbf{ and } \{ u^2h \} = d_1d_2 \nonumber \\
 &= \frac{\pm q \pm v\sqrt{f \pm g\sqrt{h}}}{p} \\
 &\quad \textbf{ where } \{ v^2f \} = t \textbf{ and } \{ v^2g \} = 2rsu \nonumber \\
 &= \frac{\pm d \pm e\sqrt{f \pm g\sqrt{h}}}{a} \\
 &\quad \textbf{ where } \{a,d,e\} = \gcd\{ p, \pm q, \pm qv \} \nonumber \\
\end{align}


\subsection{$\sqrt{C_1} = F_2$}
\begin{align*}
\sqrt{C_1} &= \sqrt{\frac{a_1\sqrt{c_1}}{b_1}}\\
 &= \frac{\sqrt{a_1b_1\sqrt{c_1}}}{b_1}     \\
 &= \frac{m\sqrt{e_2\sqrt{c_1}}}{b_1}       & a_1b_1 = m^2e_2\\
 &= \frac{a_2\sqrt{e_2\sqrt{c_1}}}{b_2}     & (a_2,b_2) = gcd(m,b_1)
\end{align*}

\subsection{$C_1 + D_2 = F_3$}
\begin{align*}
C_1 + D_2 &= \frac{\pm a_1\sqrt{c_1}}{b_1} + \frac{\pm a_2\sqrt{c_2} \pm d_2 }{b_2}\\
 &= \frac{\pm a_1b_2\sqrt{c_1} \pm a_2b_1\sqrt{c_2} \pm d_2b_1}{b_1b_2} \\
 &= \frac{\pm m\sqrt{c_1} \pm n\sqrt{c_2} \pm p}{o} 
 & (\pm m, \pm n, \pm p, o) = gcd(\pm a_1b_2, \pm a_2b_1, \pm d_2b_1, b_1b_2)\\
 &= \frac{\sqrt{m^2c_1 + n^2c_2 \pm 2mn\sqrt{c1c_2}} \pm p }{o} \\
 &= \frac{\sqrt{q \pm 2mnr\sqrt{f_3}} \pm p}{o}     & q = m^2c_1 + n^2c_2, c_1c_2 = r^2f_3\\
 &= \frac{s\sqrt{c_3 \pm e_3\sqrt{f_3}} \pm p}{o}   & q = s^2c_3, 2mnr = s^2e_3 \\
 &= \frac{a_3\sqrt{c_3 \pm e_3\sqrt{f_3}} \pm d_3}{b_3}
    & (a_3, b_3, \pm d_3) = gcd(s, \pm p, o)
\end{align*}

\subsection{$1 / D_1 = D_2$}
\begin{align*}
1 / D_1 &= \frac{b_1}{\pm a_1\sqrt{c_1} \pm d_1 }\\
 &= \frac{\pm a_1b_1\sqrt{c_1} \mp b_1d_1 }{a_1^2c_1 - d_1^2}\\
 &= \frac{a_2\sqrt{c_1} \pm d_2}{b_2}
    & (a_2, b_2, d_2) = gcd(\pm a_1b_1, \mp b_1d_1, a_1^2c_1 - d_1^2)
\end{align*}

\subsection{$\sqrt{D_1} = F_2$ editing...}
\begin{align*}
\sqrt{D_1} &= \sqrt{\frac{\pm a_1\sqrt{c_1} \pm d_1 }{b_1}}\\
 &= \frac{\sqrt{\pm b_1d_1 \pm a_1b_1\sqrt{f_2}}}{b_1}
    & f_2 = c_1\\
 &= \frac{m\sqrt{c_2 \pm e_2\sqrt{f_2}}}{b_1}
    & \pm b_1d_1 = m^2c_2, \pm a_1b_1 = m^2e_2\\
 &= \frac{a_2\sqrt{c_2 \pm e_2\sqrt{f_2}}}{b_2}
    & (a_2, b_2) = gcd(m, b_1)
\end{align*}

\subsection{$D_1 + D_2 = F_3$}
\begin{align*}
D_1 + D_2 &= \frac{\pm a_1\sqrt{c_1} \pm d_1 }{b_1} + \frac{\pm a_2\sqrt{c_2} \pm d_2 }{b_2}\\
 &= \frac{\pm a_1b_2\sqrt{c_1} \pm a_2b_1\sqrt{c_2} \pm d_1b_2 \pm d_2b_1}{b_1b_2} \\
 &= \frac{\pm m\sqrt{c_1} \pm n\sqrt{c_2} \pm p }{o}
     & (\pm m, \pm n, \pm p, o) = gcd(\pm a_1b_2, \pm a_2b_1, \pm d_1b_2 \pm d_2b_1, b_1b_2)\\
 &= \frac{\sqrt{m^2c_1 + n^2c_2 \pm 2mn\sqrt{c1c_2}} \pm p }{o} \\
 &= \frac{\sqrt{q \pm 2mnr\sqrt{f_3}} \pm p}{o}     & q = m^2c_1 + n^2c_2, c_1c_2 = r^2f_3\\
 &= \frac{s\sqrt{c_3 \pm e_3\sqrt{f_3}} \pm p}{o}   & q = s^2c_3, 2mnr = s^2e_3 \\
 &= \frac{a_3\sqrt{c_3 \pm e_3\sqrt{f_3}} \pm d_3}{b_3}
    & (a_3, b_3, \pm d_3) = gcd(s, \pm p, o)
\end{align*}

\subsection{$D_1 \times D_2 = F_3$}
\begin{align*}
D_1 \times D_2 &= \frac{\pm a_1\sqrt{c_1} \pm d_1 }{b_1} \times \frac{\pm a_2\sqrt{c_2} \pm d_2 }{b_2}\\
 &= \frac{\pm a_1a_2\sqrt{c_1c_2} \pm a_1d_2\sqrt{c1} \pm a_2d_1\sqrt{c_2} \pm d_1d_2}{b_1b_2}\\
\end{align*}

\subsection{MulDD $D_1 \times D_2 \mapsto H$ ???}
\begin{align*}
D_1 \times D_2 &= \frac{\pm b_1 \pm c_1\sqrt{d_1}}{a_1} \times \frac{\pm b_2 \pm c_2\sqrt{d_2}}{a_2}\\
 &= \frac{\pm b_1b_2 \pm b_1c_2\sqrt{d_2} \pm b_2c_1\sqrt{d_1} \pm c_1c_2\sqrt{d_1d_2} }{a_1a_2}\\
 &= \frac{\pm a_1a_2m\sqrt{c_3}}{b_1b_2} & c_1c_2 = m^2c_3\\
 &= \frac{\pm a_3\sqrt{c_3}}{b_3} & (\pm a_3,b_3) = gcd(\pm a_1a_2m,b_1b_2)
\end{align*}






















\end{document}